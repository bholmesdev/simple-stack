---
import Nested from "./Nested.astro";
import WithContext from "./WithContext.astro";
---

<RootElement data={{ count: 30 }}>
  <h1 data-target={$('test')}>Hey</h1>
  <button data-target={$('btn')}>Click</button>
  <Nested />
  <Nested />
  <Nested />
  <Nested />
  <WithContext $context={$} />
</RootElement>

<script>
  import { Signal } from 'signal-polyfill';

  RootElement.ready<{count: number}>(($, { effect, data }) => {
    const count = new Signal.State(data.count);

    $('btn').addEventListener('click', () => {
      count.set(count.get() + 1);
    });

    effect(() => {
      $('test').textContent = `Hello there! ${count.get()}`;
    });
  });
</script>
